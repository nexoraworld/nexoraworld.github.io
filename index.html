<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Nexora v4</title>
<style>

:root{
  --bg:#0a0f2c;
  --glass:rgba(255,255,255,0.08);
  --neon:#00ffff;
}

body{
  margin:0;
  font-family:Arial;
  background:linear-gradient(135deg,#0a0f2c,#1a1f4c);
  color:white;
}

header{
  display:flex;
  justify-content:space-between;
  padding:15px 30px;
  backdrop-filter:blur(10px);
  background:var(--glass);
  border-bottom:1px solid var(--neon);
}

button{
  background:var(--neon);
  border:none;
  padding:6px 12px;
  border-radius:8px;
  cursor:pointer;
  font-weight:bold;
  margin-left:5px;
}

.container{
  padding:20px;
  display:flex;
  flex-wrap:wrap;
  gap:20px;
}

.card{
  width:220px;
  background:var(--glass);
  backdrop-filter:blur(10px);
  border:1px solid var(--neon);
  border-radius:15px;
  padding:10px;
  transition:0.3s;
}

.card:hover{
  transform:translateY(-5px);
  box-shadow:0 0 15px var(--neon);
}

input, select{
  padding:6px;
  margin:5px 0;
  border-radius:6px;
  border:none;
  width:100%;
}

.modal{
  position:fixed;
  width:100%;
  height:100%;
  background:rgba(0,0,0,0.8);
  display:none;
  align-items:center;
  justify-content:center;
}

.modal-content{
  background:#111;
  padding:20px;
  width:300px;
  border:2px solid var(--neon);
  border-radius:10px;
}

.profile-box{
  padding:15px;
  border:1px solid var(--neon);
  margin:10px 0;
}

</style>
</head>
<body>

<header>
  <div>NEXORA</div>
  <div>
    <button onclick="openAuth()">Login/Register</button>
    <button onclick="openAddProduct()">+ Product</button>
    <button onclick="openProfile()">Profile</button>
  </div>
</header>

<div style="padding:10px;">
  <input id="search" placeholder="Search...">
  <select id="categoryFilter">
    <option value="all">All Categories</option>
    <option value="AI">AI</option>
    <option value="Sci-Fi">Sci-Fi</option>
    <option value="Research">Research</option>
  </select>
</div>

<div class="container" id="productContainer"></div>

<!-- AUTH MODAL -->
<div class="modal" id="authModal">
  <div class="modal-content">
    <h3>Login / Register</h3>
    <input id="authUser" placeholder="Username">
    <input id="authPass" type="password" placeholder="Password">
    <button onclick="register()">Register</button>
    <button onclick="login()">Login</button>
  </div>
</div>

<!-- PRODUCT MODAL -->
<div class="modal" id="productModal">
  <div class="modal-content">
    <h3>Add Product</h3>
    <input id="title" placeholder="Title">
    <input id="price" placeholder="Price">
    <select id="category">
      <option value="AI">AI</option>
      <option value="Sci-Fi">Sci-Fi</option>
      <option value="Research">Research</option>
    </select>
    <input id="desc" placeholder="Description">
    <button onclick="generateAI()">Generate AI Description</button>
    <button onclick="saveProduct()">Save</button>
  </div>
</div>

<!-- PROFILE MODAL -->
<div class="modal" id="profileModal">
  <div class="modal-content">
    <h3>Profile</h3>
    <div id="profileInfo"></div>
  </div>
</div>

<!-- API KEY INPUT -->
<div style="position:fixed;bottom:10px;right:10px;background:#111;padding:10px;border:1px solid cyan;">
  <input id="apiKeyInput" placeholder="Enter OpenAI API Key">
  <button onclick="saveApiKey()">Save Key</button>
</div>

<script>

/* STATE */
let users = JSON.parse(localStorage.getItem("users")) || [];
let products = JSON.parse(localStorage.getItem("products")) || [];
let currentUser = localStorage.getItem("currentUser");

/* SAVE API KEY */
function saveApiKey(){
  const key=document.getElementById("apiKeyInput").value;
  localStorage.setItem("openai_key",key);
  alert("API Key saved locally.");
}

/* AUTH SYSTEM */
function openAuth(){ document.getElementById("authModal").style.display="flex"; }

function register(){
  const u=authUser.value;
  const p=authPass.value;
  if(!u || !p) return alert("Fill all fields");
  users.push({username:u,password:p,followers:[],following:[]});
  localStorage.setItem("users",JSON.stringify(users));
  alert("Registered!");
}

function login(){
  const u=authUser.value;
  const p=authPass.value;
  const user=users.find(x=>x.username===u && x.password===p);
  if(user){
    currentUser=u;
    localStorage.setItem("currentUser",u);
    alert("Logged in");
  } else alert("Wrong credentials");
}

/* PRODUCT SYSTEM */
function openAddProduct(){
  if(!currentUser) return alert("Login first");
  document.getElementById("productModal").style.display="flex";
}

function saveProduct(){
  const product={
    id:Date.now(),
    title:title.value,
    price:price.value,
    category:category.value,
    desc:desc.value,
    owner:currentUser
  };
  products.push(product);
  localStorage.setItem("products",JSON.stringify(products));
  renderProducts();
  productModal.style.display="none";
}

function deleteProduct(id){
  products=products.filter(p=>p.id!==id);
  localStorage.setItem("products",JSON.stringify(products));
  renderProducts();
}

function renderProducts(){
  const container=document.getElementById("productContainer");
  container.innerHTML="";
  const searchVal=search.value.toLowerCase();
  const catVal=categoryFilter.value;

  products.forEach(p=>{
    if(
      (catVal==="all"||p.category===catVal) &&
      p.title.toLowerCase().includes(searchVal)
    ){
      container.innerHTML+=`
      <div class="card">
        <h4>${p.title}</h4>
        <p>${p.price}</p>
        <p>${p.category}</p>
        <p>${p.desc}</p>
        ${p.owner===currentUser ? `<button onclick="deleteProduct(${p.id})">Delete</button>` : ""}
      </div>`;
    }
  });
}

/* PROFILE */
function openProfile(){
  if(!currentUser) return alert("Login first");
  document.getElementById("profileModal").style.display="flex";
  const user=users.find(u=>u.username===currentUser);
  profileInfo.innerHTML=`
    <div class="profile-box">
      Username: ${user.username}<br>
      Followers: ${user.followers.length}<br>
      Following: ${user.following.length}
    </div>
  `;
}

/* AI INTEGRATION */
async function generateAI(){
  const apiKey=localStorage.getItem("openai_key");
  if(!apiKey) return alert("Enter API key first");

  const response=await fetch("https://api.openai.com/v1/chat/completions",{
    method:"POST",
    headers:{
      "Content-Type":"application/json",
      "Authorization":"Bearer "+apiKey
    },
    body:JSON.stringify({
      model:"gpt-4o-mini",
      messages:[{role:"user",content:"Write a futuristic product description for "+title.value}]
    })
  });

  const data=await response.json();
  desc.value=data.choices[0].message.content;
}

search.onkeyup=renderProducts;
categoryFilter.onchange=renderProducts;

renderProducts();

</script>
</body>
</html>
